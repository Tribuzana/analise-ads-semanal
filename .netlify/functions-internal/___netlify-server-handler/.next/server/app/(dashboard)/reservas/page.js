(()=>{var e={};e.id=1,e.ids=[1],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},83702:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>o.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>l}),s(72036),s(85719),s(35866),s(11506);var a=s(23191),r=s(88716),i=s(37922),o=s.n(i),n=s(95231),d={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>n[e]);s.d(t,d);let l=["",{children:["(dashboard)",{children:["reservas",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,72036)),"C:\\Users\\atend\\OneDrive\\Documents\\Cursor Tribuzana\\marketing-analytics\\app\\(dashboard)\\reservas\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,85719)),"C:\\Users\\atend\\OneDrive\\Documents\\Cursor Tribuzana\\marketing-analytics\\app\\(dashboard)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,11506)),"C:\\Users\\atend\\OneDrive\\Documents\\Cursor Tribuzana\\marketing-analytics\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\atend\\OneDrive\\Documents\\Cursor Tribuzana\\marketing-analytics\\app\\(dashboard)\\reservas\\page.tsx"],u="/(dashboard)/reservas/page",x={require:s,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/(dashboard)/reservas/page",pathname:"/reservas",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},59153:(e,t,s)=>{let a={"2cc92c78c3ec07f0212e452407dfc71afa368fb5":()=>Promise.resolve().then(s.bind(s,92555)).then(e=>e.getReservasAnalytics),"4fb7291308caa69a64f14ea764e4da7ccd3eddaa":()=>Promise.resolve().then(s.bind(s,35629)).then(e=>e.generateAlerts)};async function r(e,...t){return(await a[e]()).apply(null,t)}e.exports={"2cc92c78c3ec07f0212e452407dfc71afa368fb5":r.bind(null,"2cc92c78c3ec07f0212e452407dfc71afa368fb5"),"4fb7291308caa69a64f14ea764e4da7ccd3eddaa":r.bind(null,"4fb7291308caa69a64f14ea764e4da7ccd3eddaa")}},22277:(e,t,s)=>{Promise.resolve().then(s.bind(s,83409))},83409:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var a=s(10326),r=s(17577),i=s(91806);s(15424),(0,s(46242).$)("2cc92c78c3ec07f0212e452407dfc71afa368fb5");var o=s(33071),n=s(65304),d=s(21030),l=s(29357),c=s(78243),u=s(58831),x=s(37358),p=s(17069);function m(){let{data:e,loading:t,error:s}=function(){(0,i.j)();let[e,t]=(0,r.useState)(null),[s,a]=(0,r.useState)(!0),[o,n]=(0,r.useState)(null);return{data:e,loading:s,error:o}}();return t?(0,a.jsxs)("div",{className:"space-y-6",children:[a.jsx("h1",{className:"text-3xl font-bold",children:"An\xe1lise de Reservas"}),a.jsx(n.O,{className:"h-[400px]"})]}):s?a.jsx("div",{className:"flex h-full items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("p",{className:"text-lg font-medium text-red-600",children:"Erro ao carregar dados"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:s})]})}):e?(0,a.jsxs)("div",{className:"space-y-10 pb-8",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-3xl font-bold",children:"An\xe1lise de Reservas"}),a.jsx("p",{className:"text-muted-foreground",children:"An\xe1lise de buscas e padr\xf5es de reservas"})]}),a.jsx("div",{className:"py-6",children:(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,a.jsxs)(o.Zb,{children:[(0,a.jsxs)(o.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(o.ll,{className:"text-sm font-medium",children:"Total de Buscas"}),a.jsx(x.Z,{className:"h-4 w-4 text-muted-foreground"})]}),a.jsx(o.aY,{children:a.jsx("div",{className:"text-2xl font-bold",children:(0,u.uf)(e.totalBuscas)})})]}),(0,a.jsxs)(o.Zb,{children:[(0,a.jsxs)(o.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(o.ll,{className:"text-sm font-medium",children:"Anteced\xeancia M\xe9dia"}),a.jsx(p.Z,{className:"h-4 w-4 text-muted-foreground"})]}),a.jsx(o.aY,{children:(0,a.jsxs)("div",{className:"text-2xl font-bold",children:[e.antecedenciaMedia," dias"]})})]}),(0,a.jsxs)(o.Zb,{children:[(0,a.jsxs)(o.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(o.ll,{className:"text-sm font-medium",children:"Dura\xe7\xe3o M\xe9dia"}),a.jsx(x.Z,{className:"h-4 w-4 text-muted-foreground"})]}),a.jsx(o.aY,{children:(0,a.jsxs)("div",{className:"text-2xl font-bold",children:[e.duracaoMedia," dias"]})})]}),(0,a.jsxs)(o.Zb,{children:[(0,a.jsxs)(o.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(o.ll,{className:"text-sm font-medium",children:"Buscas por Dia"}),a.jsx(p.Z,{className:"h-4 w-4 text-muted-foreground"})]}),a.jsx(o.aY,{children:a.jsx("div",{className:"text-2xl font-bold",children:e.totalBuscas>0&&e.porDia.length>0?Math.round(e.totalBuscas/e.porDia.length):0})})]})]})}),e.porDia.length>0&&a.jsx("div",{className:"py-6",children:(0,a.jsxs)(o.Zb,{children:[(0,a.jsxs)(o.Ol,{children:[a.jsx(o.ll,{children:"Buscas ao Longo do Tempo"}),a.jsx(o.SZ,{children:"Volume de buscas por dia no per\xedodo selecionado"})]}),a.jsx(o.aY,{children:a.jsx(d.w,{data:e.porDia.map(e=>({date:new Date(e.date).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"}),Buscas:e.count})),dataKeys:[{key:"Buscas",name:"Buscas",color:"hsl(var(--primary))"}]})})]})}),a.jsx("div",{className:"py-6",children:(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[e.porDispositivo.length>0&&(0,a.jsxs)(o.Zb,{children:[(0,a.jsxs)(o.Ol,{children:[a.jsx(o.ll,{children:"Buscas por Dispositivo"}),a.jsx(o.SZ,{children:"Distribui\xe7\xe3o de buscas por tipo de dispositivo"})]}),a.jsx(o.aY,{children:a.jsx(l.u,{data:e.porDispositivo.map(e=>({name:"mobile"===e.dispositivo?"Mobile":"desktop"===e.dispositivo?"Desktop":"tablet"===e.dispositivo?"Tablet":e.dispositivo,value:e.count}))})})]}),e.porDispositivo.length>0&&(0,a.jsxs)(o.Zb,{children:[(0,a.jsxs)(o.Ol,{children:[a.jsx(o.ll,{children:"Top Dispositivos"}),a.jsx(o.SZ,{children:"Dispositivos mais utilizados para buscas"})]}),a.jsx(o.aY,{children:a.jsx(c.v,{data:e.porDispositivo.slice(0,5).map(e=>({dispositivo:"mobile"===e.dispositivo?"Mobile":"desktop"===e.dispositivo?"Desktop":"tablet"===e.dispositivo?"Tablet":e.dispositivo,count:e.count})),dataKeys:[{key:"count",name:"Buscas",color:"hsl(var(--primary))"}],xAxisKey:"dispositivo"})})]})]})})]}):null}},78243:(e,t,s)=>{"use strict";s.d(t,{v:()=>x});var a=s(10326),r=s(81398),i=s(49844),o=s(18423),n=s(62637),d=s(9997),l=s(89495),c=s(41449),u=s(48190);function x({data:e,dataKeys:t,xAxisKey:s,yAxisFormatter:x}){return a.jsx(r.h,{width:"100%",height:350,children:(0,a.jsxs)(i.v,{data:e,margin:{top:5,right:30,left:20,bottom:60},children:[a.jsx(o.q,{strokeDasharray:"3 3"}),a.jsx(n.K,{dataKey:s,tick:{fontSize:11},angle:-45,textAnchor:"end",height:80,interval:0}),a.jsx(d.B,{tick:{fontSize:12},tickFormatter:x}),a.jsx(l.u,{contentStyle:{backgroundColor:"hsl(var(--popover))",border:"1px solid hsl(var(--border))",borderRadius:"6px"},formatter:(e,t)=>"ROAS"===t||"roas"===t?`${Number(e).toFixed(2).replace(".",",")}x`:e}),a.jsx(c.D,{}),t.map(({key:e,name:t,color:s})=>a.jsx(u.$Q,{dataKey:e,name:t,fill:s},e))]})})}},21030:(e,t,s)=>{"use strict";s.d(t,{w:()=>p});var a=s(10326),r=s(81398),i=s(14958),o=s(18423),n=s(62637),d=s(9997),l=s(89495),c=s(41449),u=s(71094),x=s(58831);function p({data:e,dataKeys:t,xAxisKey:s="date",yAxisFormatter:p}){return a.jsx(r.h,{width:"100%",height:300,children:(0,a.jsxs)(i.w,{data:e,children:[a.jsx(o.q,{strokeDasharray:"3 3"}),a.jsx(n.K,{dataKey:s,tick:{fontSize:12},angle:-45,textAnchor:"end",height:80}),a.jsx(d.B,{tick:{fontSize:12},tickFormatter:p}),a.jsx(l.u,{contentStyle:{backgroundColor:"hsl(var(--popover))",border:"1px solid hsl(var(--border))",borderRadius:"6px"},formatter:(e,s)=>{let a=t.find(e=>e.key===s||e.name===s);return a?.formatter?a.formatter(e):"Investimento"===s||"Receita"===s?(0,x.xG)(e):"ROAS"===s||"roas"===s?`${Number(e).toFixed(2).replace(".",",")}x`:e}}),a.jsx(c.D,{}),t.map(({key:e,name:t,color:s})=>a.jsx(u.x1,{type:"monotone",dataKey:e,name:t,stroke:s,strokeWidth:2,dot:{r:4}},e))]})})}},29357:(e,t,s)=>{"use strict";s.d(t,{u:()=>x});var a=s(10326),r=s(81398),i=s(14141),o=s(97651),n=s(99630),d=s(89495),l=s(41449),c=s(58831);let u=["hsl(var(--primary))","hsl(var(--secondary))","#8884d8","#82ca9d","#ffc658","#ff7300"];function x({data:e,colors:t=u}){return a.jsx(r.h,{width:"100%",height:300,children:(0,a.jsxs)(i.u,{children:[a.jsx(o.by,{data:e,cx:"50%",cy:"50%",labelLine:!1,label:({name:e,percent:t,value:s})=>`${e}: ${(100*(t||0)).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:e.map((e,s)=>a.jsx(n.b,{fill:t[s%t.length]},`cell-${s}`))}),a.jsx(d.u,{contentStyle:{backgroundColor:"hsl(var(--popover))",border:"1px solid hsl(var(--border))",borderRadius:"6px"},formatter:e=>(0,c.xG)(e)}),a.jsx(l.D,{})]})})}},65304:(e,t,s)=>{"use strict";s.d(t,{O:()=>i});var a=s(10326),r=s(11105);function i({className:e,...t}){return a.jsx("div",{className:(0,r.cn)("animate-pulse rounded-md bg-muted",e),...t})}},58831:(e,t,s)=>{"use strict";s.d(t,{p6:()=>o,rl:()=>i,uf:()=>r,xG:()=>a});let a=e=>null==e?"R$ 0,00":new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),r=e=>null==e?"0":new Intl.NumberFormat("pt-BR").format(e),i=(e,t=2)=>null==e?"0%":`${e.toFixed(t)}%`,o=e=>{let t="string"==typeof e?new Date(e):e;return new Intl.DateTimeFormat("pt-BR").format(t)}},72036:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(68570).createProxy)(String.raw`C:\Users\atend\OneDrive\Documents\Cursor Tribuzana\marketing-analytics\app\(dashboard)\reservas\page.tsx#default`)},92555:(e,t,s)=>{"use strict";s.r(t),s.d(t,{getReservasAnalytics:()=>i});var a=s(27745);s(26461);var r=s(94964);async function i(e){let t=(0,r.e)();try{if(!e.startDate||!e.endDate)return{totalBuscas:0,porDia:[],porDispositivo:[],porCidade:[],antecedenciaMedia:0,duracaoMedia:0};let s=[];if(e.selectedHotels.length>0||e.selectedCidades.length>0||e.selectedEstados.length>0){let a=t.from("hoteis_config").select("id, motor_id").eq("ativo",!0);e.selectedHotels.length>0&&a.in("nome_hotel",e.selectedHotels),e.selectedCidades.length>0&&a.in("cidade",e.selectedCidades),e.selectedEstados.length>0&&a.in("estado",e.selectedEstados);let{data:r}=await a;s=r?.map(e=>e.id)||[]}let a=t.from("coletas_reservas").select("*").gte("data_coleta",e.startDate).lte("data_coleta",e.endDate);if(s.length>0){let{data:e}=await t.from("hoteis_config").select("motor_id").in("id",s),r=e?.map(e=>e.motor_id).filter(Boolean)||[];r.length>0&&(a=a.in("motor_id",r))}let{data:r,error:i}=await a;if(i)throw console.error("[getReservasAnalytics] Erro:",i),i;if(!r||0===r.length)return{totalBuscas:0,porDia:[],porDispositivo:[],porCidade:[],antecedenciaMedia:0,duracaoMedia:0};let o=new Map;r.forEach(e=>{let t=new Date(e.data_coleta).toISOString().split("T")[0];o.set(t,(o.get(t)||0)+1)});let n=Array.from(o.entries()).map(([e,t])=>({date:e,count:t})).sort((e,t)=>e.date.localeCompare(t.date)),d=new Map;r.forEach(e=>{let t=e.dispositivo||"N\xe3o informado";d.set(t,(d.get(t)||0)+1)});let l=Array.from(d.entries()).map(([e,t])=>({dispositivo:e,count:t})).sort((e,t)=>t.count-e.count),c=r.map(e=>e.antecedencia_dias).filter(e=>null!=e),u=r.map(e=>e.duracao_dias).filter(e=>null!=e),x=c.length>0?c.reduce((e,t)=>e+t,0)/c.length:0,p=u.length>0?u.reduce((e,t)=>e+t,0)/u.length:0;return{totalBuscas:r.length,porDia:n,porDispositivo:l,porCidade:[],antecedenciaMedia:Math.round(x),duracaoMedia:Math.round(p)}}catch(e){return console.error("[getReservasAnalytics] Erro:",e),{totalBuscas:0,porDia:[],porDispositivo:[],porCidade:[],antecedenciaMedia:0,duracaoMedia:0}}}(0,s(85723).h)([i]),(0,a.j)("2cc92c78c3ec07f0212e452407dfc71afa368fb5",i)}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[276,992,162,808,981,220],()=>s(83702));module.exports=a})();