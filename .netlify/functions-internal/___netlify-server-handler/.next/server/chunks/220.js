exports.id=220,exports.ids=[220],exports.modules={58747:(e,a,t)=>{Promise.resolve().then(t.bind(t,66192)),Promise.resolve().then(t.bind(t,23238)),Promise.resolve().then(t.bind(t,33136)),Promise.resolve().then(t.bind(t,91806))},38954:(e,a,t)=>{Promise.resolve().then(t.t.bind(t,12994,23)),Promise.resolve().then(t.t.bind(t,96114,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,79671,23)),Promise.resolve().then(t.t.bind(t,41868,23)),Promise.resolve().then(t.t.bind(t,84759,23))},19369:(e,a,t)=>{Promise.resolve().then(t.bind(t,85999))},66192:(e,a,t)=>{"use strict";t.d(a,{Sidebar:()=>C});var s=t(10326),r=t(17577),n=t(90434),i=t(46226),o=t(35047),l=t(11105),d=t(24319),c=t(17069),m=t(54014),u=t(71806),p=t(37358),f=t(6507),h=t(88378),x=t(39183),g=t(11890),y=t(32471);let v=y.zt,b=y.fC,j=y.xz,_=r.forwardRef(({className:e,sideOffset:a=4,...t},r)=>s.jsx(y.VY,{ref:r,sideOffset:a,className:(0,l.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));_.displayName=y.VY.displayName;var N=t(90772);let w=[{name:"Dashboard",href:"/",icon:d.Z},{name:"Marketing Analytics",href:"/marketing-analytics",icon:c.Z},{name:"Google Ads",href:"/google-ads",icon:m.Z},{name:"Meta Ads",href:"/meta-ads",icon:u.Z},{name:"Reservas",href:"/reservas",icon:p.Z},{name:"Alertas",href:"/alertas",icon:f.Z},{name:"Configura\xe7\xf5es",href:"/configuracoes",icon:h.Z}];function C(){let e=(0,o.usePathname)(),[a,t]=(0,r.useState)(!1);return s.jsx("aside",{className:(0,l.cn)("hidden border-r bg-card lg:block transition-all duration-300",a?"w-16":"w-64"),children:(0,s.jsxs)("div",{className:"flex h-full flex-col",children:[s.jsx("div",{className:"flex h-16 items-center justify-between border-b px-4",children:a?s.jsx("div",{className:"flex items-center justify-center w-full",children:s.jsx(i.default,{src:"/logo-tribuzana.png",alt:"Tribuzana",width:32,height:32,className:"object-contain"})}):(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[s.jsx(i.default,{src:"/logo-tribuzana.png",alt:"Tribuzana",width:32,height:32,className:"object-contain"}),s.jsx("h1",{className:"text-xl font-bold text-primary",children:"Tribuzana"})]})}),s.jsx("nav",{className:"flex-1 space-y-1 p-4",children:s.jsx(v,{children:w.map(t=>{let r=e===t.href,i=(0,s.jsxs)(n.default,{href:t.href,className:(0,l.cn)("flex items-center gap-3 rounded-lg px-3 py-2 text-sm font-medium transition-colors",a?"justify-center":"",r?"bg-primary text-primary-foreground":"text-muted-foreground hover:bg-accent hover:text-accent-foreground"),children:[s.jsx(t.icon,{className:"h-5 w-5 flex-shrink-0"}),!a&&s.jsx("span",{children:t.name})]});return a?(0,s.jsxs)(b,{children:[s.jsx(j,{asChild:!0,children:i}),s.jsx(_,{side:"right",children:s.jsx("p",{children:t.name})})]},t.name):s.jsx("div",{children:i},t.name)})})}),s.jsx("div",{className:"border-t p-2",children:s.jsx(N.z,{variant:"ghost",size:"icon",onClick:()=>{t(!a)},className:"w-full",children:a?s.jsx(x.Z,{className:"h-5 w-5"}):s.jsx(g.Z,{className:"h-5 w-5"})})})]})})}},23238:(e,a,t)=>{"use strict";t.d(a,{TopBar:()=>er});var s=t(10326),r=t(95035),n=t(17577),i=t(91806),o=t(68346),l=t(90772),d=t(12790),c=t(11105);let m=d.fC,u=d.xz,p=n.forwardRef(({className:e,align:a="center",sideOffset:t=4,...r},n)=>s.jsx(d.h_,{children:s.jsx(d.VY,{ref:n,align:a,sideOffset:t,className:(0,c.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));p.displayName=d.VY.displayName;var f=t(78589),h=t(32933);let x=n.forwardRef(({className:e,...a},t)=>s.jsx(f.fC,{ref:t,className:(0,c.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...a,children:s.jsx(f.z$,{className:(0,c.cn)("flex items-center justify-center text-current"),children:s.jsx(h.Z,{className:"h-4 w-4"})})}));x.displayName=f.fC.displayName;var g=t(43712),y=t(941);function v(){let[e,a]=(0,n.useState)(!1),{selectedHotels:t,setSelectedHotels:r}=(0,i.j)(),{hoteis:d,loading:c}=(0,o.q)(),f=e=>{t.includes(e)?r(t.filter(a=>a!==e)):r([...t,e])};return(0,s.jsxs)(m,{open:e,onOpenChange:a,children:[s.jsx(u,{asChild:!0,children:(0,s.jsxs)(l.z,{variant:"outline",className:"w-full justify-between sm:w-[300px]",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[s.jsx(g.Z,{className:"h-4 w-4"}),s.jsx("span",{children:0===t.length?"Selecione os hot\xe9is":`${t.length} hotel(is) selecionado(s)`})]}),s.jsx(y.Z,{className:"ml-2 h-4 w-4 opacity-50"})]})}),(0,s.jsxs)(p,{className:"w-[400px] p-0",align:"start",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between border-b p-3",children:[s.jsx("span",{className:"text-sm font-medium",children:"Hot\xe9is"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[s.jsx(l.z,{variant:"ghost",size:"sm",onClick:()=>{r(d.map(e=>e.nome_hotel))},className:"h-7 text-xs",children:"Todos"}),s.jsx(l.z,{variant:"ghost",size:"sm",onClick:()=>{r([])},className:"h-7 text-xs",children:"Limpar"})]})]}),s.jsx("div",{className:"max-h-[300px] overflow-y-auto p-3",children:c?s.jsx("div",{className:"text-center text-sm text-muted-foreground",children:"Carregando..."}):0===d.length?s.jsx("div",{className:"text-center text-sm text-muted-foreground",children:"Nenhum hotel encontrado"}):s.jsx("div",{className:"space-y-2",children:d.map(e=>(0,s.jsxs)("div",{className:"flex items-center space-x-2 rounded-md p-2 hover:bg-accent",children:[s.jsx(x,{id:e.nome_hotel,checked:t.includes(e.nome_hotel),onCheckedChange:()=>f(e.nome_hotel)}),s.jsx("label",{htmlFor:e.nome_hotel,className:"flex-1 cursor-pointer text-sm font-medium leading-none whitespace-nowrap peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:e.nome_fantasia||e.nome_hotel})]},e.id))})})]})]})}var b=t(94629),j=t(34231),_=t(6042),N=t(37358),w=t(8122),C=t(30054);function z({className:e,classNames:a,showOutsideDays:t=!0,numberOfMonths:r=1,...n}){return s.jsx(C._,{showOutsideDays:t,numberOfMonths:r,className:(0,c.cn)("p-0",e),classNames:{months:"flex flex-col space-y-4",month:"space-y-3",caption:"flex justify-center pt-1 relative items-center mb-4",caption_label:"text-base font-semibold text-primary",nav:"space-x-1 flex items-center",nav_button:(0,c.cn)((0,l.d)({variant:"ghost"}),"h-7 w-7 p-0 rounded-md"),nav_button_previous:"absolute left-0",nav_button_next:"absolute right-0",table:"w-full border-collapse",head_row:"flex w-full mb-3",head_cell:"",row:"",cell:"relative focus-within:relative focus-within:z-20",day:(0,c.cn)((0,l.d)({variant:"ghost"}),"h-10 w-10 p-0 font-medium rounded-lg"),day_range_end:"",day_selected:"",day_today:"",day_outside:"",day_disabled:"",day_range_middle:"",day_hidden:"invisible",...a},...n})}z.displayName="Calendar";var S=t(27696);function k(){let{startDate:e,endDate:a,setDateRange:t,compareYearAgo:r,setCompareYearAgo:o}=(0,i.j)(),[d,f]=(0,n.useState)(!1),[h,x]=(0,n.useState)(()=>{if(e&&a)try{return{from:(0,b.D)(e),to:(0,b.D)(a)}}catch{}}),[g,y]=(0,n.useState)(r),v=e=>{let a;switch(e){case"default":a=(0,S.e6)();break;case"lastWeek":a=(0,S.c8)();break;case"thisMonth":a=(0,S.f)();break;case"lastMonth":a=(0,S.WF)()}x({from:(0,b.D)(a.startDate),to:(0,b.D)(a.endDate)})},C=h||(e&&a?{from:(0,b.D)(e),to:(0,b.D)(a)}:void 0);return s.jsx("div",{className:"flex flex-col gap-2",children:(0,s.jsxs)(m,{open:d,onOpenChange:f,children:[s.jsx(u,{asChild:!0,children:(0,s.jsxs)(l.z,{variant:"outline",className:(0,c.cn)("w-full justify-start text-left font-normal sm:w-[300px]",!C&&"text-muted-foreground"),children:[s.jsx(N.Z,{className:"mr-2 h-4 w-4"}),C?.from?C.to?(0,s.jsxs)(s.Fragment,{children:[(0,j.WU)(C.from,"dd/MM/yyyy",{locale:_.F})," -"," ",(0,j.WU)(C.to,"dd/MM/yyyy",{locale:_.F})]}):(0,j.WU)(C.from,"dd/MM/yyyy",{locale:_.F}):s.jsx("span",{children:"Selecione o per\xedodo"})]})}),s.jsx(p,{className:"w-auto p-0",align:"start",children:(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("div",{className:"p-4 border-b",children:[s.jsx("h3",{className:"text-sm font-medium text-foreground mb-3",children:"Per\xedodos r\xe1pidos"}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2 mb-3",children:[s.jsx(l.z,{variant:"outline",size:"sm",onClick:()=>v("lastWeek"),className:(0,c.cn)("text-xs h-8 px-3 rounded-md bg-muted/50 hover:bg-muted text-muted-foreground border-muted-foreground/20 font-normal",h?.from&&h?.to&&(0,j.WU)(h.from,"yyyy-MM-dd")===(0,S.c8)().startDate&&(0,j.WU)(h.to,"yyyy-MM-dd")===(0,S.c8)().endDate&&"bg-primary/10 text-primary border-primary/30"),children:"Semana passada"}),s.jsx(l.z,{variant:"outline",size:"sm",onClick:()=>v("default"),className:(0,c.cn)("text-xs h-8 px-3 rounded-md bg-muted/50 hover:bg-muted text-muted-foreground border-muted-foreground/20 font-normal",h?.from&&h?.to&&(0,j.WU)(h.from,"yyyy-MM-dd")===(0,S.e6)().startDate&&(0,j.WU)(h.to,"yyyy-MM-dd")===(0,S.e6)().endDate&&"bg-primary/10 text-primary border-primary/30"),children:"\xdaltimos 7 dias"}),s.jsx(l.z,{variant:"outline",size:"sm",onClick:()=>v("thisMonth"),className:(0,c.cn)("text-xs h-8 px-3 rounded-md bg-muted/50 hover:bg-muted text-muted-foreground border-muted-foreground/20 font-normal",h?.from&&h?.to&&(0,j.WU)(h.from,"yyyy-MM-dd")===(0,S.f)().startDate&&(0,j.WU)(h.to,"yyyy-MM-dd")===(0,S.f)().endDate&&"bg-primary/10 text-primary border-primary/30"),children:"Este m\xeas"}),s.jsx(l.z,{variant:"outline",size:"sm",onClick:()=>v("lastMonth"),className:(0,c.cn)("text-xs h-8 px-3 rounded-md bg-muted/50 hover:bg-muted text-muted-foreground border-muted-foreground/20 font-normal",h?.from&&h?.to&&(0,j.WU)(h.from,"yyyy-MM-dd")===(0,S.WF)().startDate&&(0,j.WU)(h.to,"yyyy-MM-dd")===(0,S.WF)().endDate&&"bg-primary/10 text-primary border-primary/30"),children:"M\xeas passado"})]}),(0,s.jsxs)(l.z,{variant:g?"default":"outline",size:"sm",onClick:()=>y(!g),className:"w-full gap-2 h-9",children:[s.jsx(w.Z,{className:"h-4 w-4"}),"Comparar com ano anterior"]})]}),(0,s.jsxs)("div",{className:"p-4 border-b",children:[s.jsx("h3",{className:"text-sm font-medium text-foreground mb-3",children:"Per\xedodo personalizado"}),s.jsx(z,{initialFocus:!0,mode:"range",defaultMonth:h?.from,selected:h,onSelect:e=>{x(e)},numberOfMonths:1,locale:_.F})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2 p-4 border-t bg-muted/30",children:[s.jsx(l.z,{variant:"outline",size:"sm",onClick:()=>{if(e&&a)try{x({from:(0,b.D)(e),to:(0,b.D)(a)})}catch{x(void 0)}y(r),f(!1)},className:"gap-2 bg-background",children:"Cancelar"}),s.jsx(l.z,{variant:"default",size:"sm",onClick:()=>{h?.from&&h?.to&&(t((0,j.WU)(h.from,"yyyy-MM-dd"),(0,j.WU)(h.to,"yyyy-MM-dd")),o(g),f(!1))},disabled:!h?.from||!h?.to,className:"bg-primary hover:bg-primary/90",children:"Aplicar"})]})]})})]})})}var D=t(31048),M=t(77636);function A(){let{hoteis:e}=(0,o.q)(),{selectedCidades:a,setSelectedCidades:t}=(0,i.j)(),[r,d]=(0,n.useState)(!1),f=Array.from(new Set(e.map(e=>e.cidade).filter(e=>null!==e&&""!==e))).sort(),h=e=>{a.includes(e)?t(a.filter(a=>a!==e)):t([...a,e])};return(0,s.jsxs)(m,{open:r,onOpenChange:d,children:[s.jsx(u,{asChild:!0,children:(0,s.jsxs)(l.z,{variant:"outline",size:"sm",className:(0,c.cn)("gap-2",a.length>0&&"bg-primary/10 border-primary"),children:[s.jsx(M.Z,{className:"h-4 w-4"}),"Cidades",a.length>0&&s.jsx("span",{className:"ml-1 rounded-full bg-primary px-2 py-0.5 text-xs text-primary-foreground",children:a.length})]})}),s.jsx(p,{className:"w-64 p-0",align:"start",children:(0,s.jsxs)("div",{className:"p-4 space-y-3",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(D._,{className:"text-sm font-semibold",children:"Filtrar por Cidade"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Selecione uma ou mais cidades"})]}),s.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:0===f.length?s.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Nenhuma cidade dispon\xedvel"}):f.map(e=>(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[s.jsx(x,{id:`cidade-${e}`,checked:a.includes(e),onCheckedChange:()=>h(e)}),s.jsx(D._,{htmlFor:`cidade-${e}`,className:"text-sm font-normal cursor-pointer flex-1",children:e})]},e))}),a.length>0&&s.jsx(l.z,{variant:"ghost",size:"sm",className:"w-full",onClick:()=>t([]),children:"Limpar sele\xe7\xe3o"})]})})]})}function O(){let{hoteis:e}=(0,o.q)(),{selectedEstados:a,setSelectedEstados:t}=(0,i.j)(),[r,d]=(0,n.useState)(!1),f=Array.from(new Set(e.map(e=>e.estado).filter(e=>null!==e&&""!==e))).sort(),h=e=>{a.includes(e)?t(a.filter(a=>a!==e)):t([...a,e])};return(0,s.jsxs)(m,{open:r,onOpenChange:d,children:[s.jsx(u,{asChild:!0,children:(0,s.jsxs)(l.z,{variant:"outline",size:"sm",className:(0,c.cn)("gap-2",a.length>0&&"bg-primary/10 border-primary"),children:[s.jsx(M.Z,{className:"h-4 w-4"}),"Estados",a.length>0&&s.jsx("span",{className:"ml-1 rounded-full bg-primary px-2 py-0.5 text-xs text-primary-foreground",children:a.length})]})}),s.jsx(p,{className:"w-64 p-0",align:"start",children:(0,s.jsxs)("div",{className:"p-4 space-y-3",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(D._,{className:"text-sm font-semibold",children:"Filtrar por Estado"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Selecione um ou mais estados"})]}),s.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:0===f.length?s.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Nenhum estado dispon\xedvel"}):f.map(e=>(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[s.jsx(x,{id:`estado-${e}`,checked:a.includes(e),onCheckedChange:()=>h(e)}),s.jsx(D._,{htmlFor:`estado-${e}`,className:"text-sm font-normal cursor-pointer flex-1",children:e})]},e))}),a.length>0&&s.jsx(l.z,{variant:"ghost",size:"sm",className:"w-full",onClick:()=>t([]),children:"Limpar sele\xe7\xe3o"})]})})]})}var F=t(41137);let I=["Vendas","Busca","Performance Max","Engajamento","Leads","Tr\xe1fego","Hotel","Gera\xe7\xe3o de Demanda","Inteligente","V\xeddeo","Cliques em Links","Mensagens"],$=["Convers\xf5es","Leads","Cliques em Links","Engajamentos em Posts","Compras"];function R(){let[e,a]=(0,n.useState)(!1),{selectedObjectives:t,setSelectedObjectives:r,selectedResultTypes:o,setSelectedResultTypes:d}=(0,i.j)(),c=e=>{t.includes(e)?r(t.filter(a=>a!==e)):r([...t,e])},f=e=>{o.includes(e)?d(o.filter(a=>a!==e)):d([...o,e])},h=t.length+o.length,g=0===h?"Filtros Avan\xe7ados":`${h} filtro(s) selecionado(s)`;return(0,s.jsxs)(m,{open:e,onOpenChange:a,children:[s.jsx(u,{asChild:!0,children:(0,s.jsxs)(l.z,{variant:"outline",className:"w-full justify-between sm:w-[200px]",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[s.jsx(F.Z,{className:"h-4 w-4"}),s.jsx("span",{children:g})]}),s.jsx(y.Z,{className:"ml-2 h-4 w-4 opacity-50"})]})}),(0,s.jsxs)(p,{className:"w-[400px] p-0",align:"start",children:[(0,s.jsxs)("div",{className:"border-b",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between border-b p-3",children:[(0,s.jsxs)("span",{className:"text-sm font-medium flex items-center gap-2",children:[s.jsx(F.Z,{className:"h-4 w-4"}),"Objetivo de Campanha"]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[s.jsx(l.z,{variant:"ghost",size:"sm",onClick:()=>{r(I)},className:"h-7 text-xs",children:"Todos"}),s.jsx(l.z,{variant:"ghost",size:"sm",onClick:()=>{r([])},className:"h-7 text-xs",children:"Limpar"})]})]}),s.jsx("div",{className:"max-h-[300px] overflow-y-auto p-3",children:s.jsx("div",{className:"space-y-2",children:I.map(e=>(0,s.jsxs)("div",{className:"flex items-center space-x-2 rounded-md p-2 hover:bg-accent",children:[s.jsx(x,{id:`objective-${e}`,checked:t.includes(e),onCheckedChange:()=>c(e)}),s.jsx("label",{htmlFor:`objective-${e}`,className:"flex-1 cursor-pointer text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:e})]},e))})})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between border-b p-3",children:[(0,s.jsxs)("span",{className:"text-sm font-medium flex items-center gap-2",children:[s.jsx(F.Z,{className:"h-4 w-4"}),"Tipo de Resultado"]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[s.jsx(l.z,{variant:"ghost",size:"sm",onClick:()=>{d($)},className:"h-7 text-xs",children:"Todos"}),s.jsx(l.z,{variant:"ghost",size:"sm",onClick:()=>{d([])},className:"h-7 text-xs",children:"Limpar"})]})]}),s.jsx("div",{className:"max-h-[300px] overflow-y-auto p-3",children:s.jsx("div",{className:"space-y-2",children:$.map(e=>(0,s.jsxs)("div",{className:"flex items-center space-x-2 rounded-md p-2 hover:bg-accent",children:[s.jsx(x,{id:`resultType-${e}`,checked:o.includes(e),onCheckedChange:()=>f(e)}),s.jsx("label",{htmlFor:`resultType-${e}`,className:"flex-1 cursor-pointer text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:e})]},e))})})]})]})]})}var U=t(54689);function P(){let{resetFilters:e}=(0,i.j)();return(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-3 rounded-lg border bg-card p-4",children:[s.jsx(v,{}),s.jsx(A,{}),s.jsx(O,{}),s.jsx(k,{}),s.jsx(R,{}),(0,s.jsxs)(l.z,{variant:"ghost",size:"sm",onClick:e,className:"gap-2",children:[s.jsx(U.Z,{className:"h-4 w-4"}),"Limpar filtros"]})]})}var E=t(73116),Z=t(567),W=t(6507),T=t(90434);function L(){let{stats:e,loading:a}=(0,E.Z)();if(a)return null;let t=e.total>0,r=e.critical>0;return s.jsx(T.default,{href:"/alertas",children:(0,s.jsxs)(l.z,{variant:"ghost",size:"icon",className:"relative",children:[s.jsx(W.Z,{className:"h-5 w-5"}),t&&s.jsx(Z.C,{variant:"destructive",className:`absolute -top-1 -right-1 h-5 w-5 p-0 flex items-center justify-center text-xs ${r?"bg-red-500":"bg-yellow-500"}`,children:e.total>99?"99+":e.total})]})})}var V=t(5800);let H=V.fC,Y=V.xz;V.ZA,V.Uv,V.Tr,V.Ee,n.forwardRef(({className:e,inset:a,children:t,...r},n)=>s.jsx(V.fF,{ref:n,className:(0,c.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",a&&"pl-8",e),...r,children:t})).displayName=V.fF.displayName,n.forwardRef(({className:e,...a},t)=>s.jsx(V.tu,{ref:t,className:(0,c.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...a})).displayName=V.tu.displayName;let J=n.forwardRef(({className:e,sideOffset:a=4,...t},r)=>s.jsx(V.Uv,{children:s.jsx(V.VY,{ref:r,sideOffset:a,className:(0,c.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t})}));J.displayName=V.VY.displayName;let B=n.forwardRef(({className:e,inset:a,...t},r)=>s.jsx(V.ck,{ref:r,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a&&"pl-8",e),...t}));B.displayName=V.ck.displayName,n.forwardRef(({className:e,children:a,checked:t,...r},n)=>s.jsx(V.oC,{ref:n,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:t,...r,children:a})).displayName=V.oC.displayName,n.forwardRef(({className:e,children:a,...t},r)=>s.jsx(V.Rk,{ref:r,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...t,children:a})).displayName=V.Rk.displayName;let q=n.forwardRef(({className:e,inset:a,...t},r)=>s.jsx(V.__,{ref:r,className:(0,c.cn)("px-2 py-1.5 text-sm font-semibold",a&&"pl-8",e),...t}));q.displayName=V.__.displayName;let G=n.forwardRef(({className:e,...a},t)=>s.jsx(V.Z0,{ref:t,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",e),...a}));G.displayName=V.Z0.displayName;var X=t(56145);let Q=n.forwardRef(({className:e,...a},t)=>s.jsx(X.fC,{ref:t,className:(0,c.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...a}));Q.displayName=X.fC.displayName;let K=n.forwardRef(({className:e,...a},t)=>s.jsx(X.Ee,{ref:t,className:(0,c.cn)("aspect-square h-full w-full",e),...a}));K.displayName=X.Ee.displayName;let ee=n.forwardRef(({className:e,...a},t)=>s.jsx(X.NY,{ref:t,className:(0,c.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...a}));ee.displayName=X.NY.displayName;var ea=t(71810),et=t(35047),es=t(85999);function er(){let{usuario:e,signOut:a}=(0,r.a)(),t=(0,et.useRouter)(),n=async()=>{try{try{await a()}catch(e){console.warn("[handleSignOut] Erro no signOut do contexto, tentando API:",e);try{await fetch("/api/auth/logout",{method:"POST"})}catch(e){console.error("[handleSignOut] Erro na API de logout:",e)}}es.A.success("Logout realizado com sucesso"),t.push("/login"),t.refresh()}catch(e){console.error("[handleSignOut] Erro geral:",e),es.A.error("Erro ao fazer logout. Redirecionando..."),t.push("/login"),t.refresh()}};return(0,s.jsxs)("header",{className:"border-b bg-background",children:[(0,s.jsxs)("div",{className:"flex h-16 items-center justify-between px-6",children:[s.jsx("h2",{className:"text-lg font-semibold",children:"Dashboard"}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[s.jsx(L,{}),(0,s.jsxs)(H,{children:[s.jsx(Y,{asChild:!0,children:s.jsx(l.z,{variant:"ghost",className:"relative h-10 w-10 rounded-full",children:(0,s.jsxs)(Q,{children:[s.jsx(K,{src:e?.avatar_url||""}),s.jsx(ee,{children:e?e.nome_completo.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2):"U"})]})})}),(0,s.jsxs)(J,{align:"end",className:"w-56",children:[s.jsx(q,{children:(0,s.jsxs)("div",{className:"flex flex-col space-y-1",children:[s.jsx("p",{className:"text-sm font-medium",children:e?.nome_completo}),s.jsx("p",{className:"text-xs text-muted-foreground",children:e?.email}),s.jsx("p",{className:"text-xs text-muted-foreground capitalize",children:e?.nivel_acesso})]})}),s.jsx(G,{}),(0,s.jsxs)(B,{onClick:n,children:[s.jsx(ea.Z,{className:"mr-2 h-4 w-4"}),"Sair"]})]})]})]})]}),s.jsx("div",{className:"px-6 pb-4",children:s.jsx(P,{})})]})}},567:(e,a,t)=>{"use strict";t.d(a,{C:()=>o});var s=t(10326);t(17577);var r=t(79360),n=t(11105);let i=(0,r.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o({className:e,variant:a,...t}){return s.jsx("div",{className:(0,n.cn)(i({variant:a}),e),...t})}},90772:(e,a,t)=>{"use strict";t.d(a,{d:()=>o,z:()=>l});var s=t(10326),r=t(17577),n=t(79360),i=t(11105);let o=(0,n.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),l=r.forwardRef(({className:e,variant:a,size:t,...r},n)=>s.jsx("button",{className:(0,i.cn)(o({variant:a,size:t,className:e})),ref:n,...r}));l.displayName="Button"},33071:(e,a,t)=>{"use strict";t.d(a,{Ol:()=>o,SZ:()=>d,Zb:()=>i,aY:()=>c,ll:()=>l});var s=t(10326),r=t(17577),n=t(11105);let i=r.forwardRef(({className:e,...a},t)=>s.jsx("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...a}));i.displayName="Card";let o=r.forwardRef(({className:e,...a},t)=>s.jsx("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-2 p-6",e),...a}));o.displayName="CardHeader";let l=r.forwardRef(({className:e,...a},t)=>s.jsx("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",e),...a}));l.displayName="CardTitle";let d=r.forwardRef(({className:e,...a},t)=>s.jsx("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",e),...a}));d.displayName="CardDescription";let c=r.forwardRef(({className:e,...a},t)=>s.jsx("div",{ref:t,className:(0,n.cn)("p-6 pt-0",e),...a}));c.displayName="CardContent",r.forwardRef(({className:e,...a},t)=>s.jsx("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",e),...a})).displayName="CardFooter"},31048:(e,a,t)=>{"use strict";t.d(a,{_:()=>d});var s=t(10326),r=t(17577),n=t(34478),i=t(79360),o=t(11105);let l=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=r.forwardRef(({className:e,...a},t)=>s.jsx(n.f,{ref:t,className:(0,o.cn)(l(),e),...a}));d.displayName=n.f.displayName},33136:(e,a,t)=>{"use strict";t.d(a,{AuthProvider:()=>o,a:()=>l});var s=t(10326),r=t(17577),n=t(42945);let i=(0,r.createContext)(void 0);function o({children:e}){let[a,t]=(0,r.useState)(null),[o,l]=(0,r.useState)(null),[d,c]=(0,r.useState)(!0),m=(0,n.e)(),u=async(e,a)=>{let{error:t}=await m.auth.signInWithPassword({email:e,password:a});if(t)throw t},p=async()=>{try{let{error:e}=await m.auth.signOut();if(e)throw console.error("[signOut] Erro do Supabase:",e),t(null),l(null),e;t(null),l(null)}catch(e){throw console.error("[signOut] Erro ao fazer logout:",e),t(null),l(null),e}};return s.jsx(i.Provider,{value:{user:a,usuario:o,loading:d,signIn:u,signOut:p},children:e})}let l=()=>{let e=(0,r.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},91806:(e,a,t)=>{"use strict";t.d(a,{FilterProvider:()=>o,j:()=>l});var s=t(10326),r=t(17577),n=t(27696);let i=(0,r.createContext)(void 0);function o({children:e}){let{startDate:a,endDate:t}=(0,n.e6)(),[o,l]=(0,r.useState)([]),[d,c]=(0,r.useState)(a),[m,u]=(0,r.useState)(t),[p,f]=(0,r.useState)([]),[h,x]=(0,r.useState)([]),[g,y]=(0,r.useState)(!1),[v,b]=(0,r.useState)([]),[j,_]=(0,r.useState)([]);return s.jsx(i.Provider,{value:{selectedHotels:o,startDate:d,endDate:m,selectedCidades:p,selectedEstados:h,compareYearAgo:g,selectedObjectives:v,selectedResultTypes:j,setSelectedHotels:l,setDateRange:(e,a)=>{c(e),u(a)},setSelectedCidades:f,setSelectedEstados:x,setCompareYearAgo:y,setSelectedObjectives:b,setSelectedResultTypes:_,resetFilters:()=>{l([]);let{startDate:e,endDate:a}=(0,n.e6)();c(e),u(a),f([]),x([]),y(!1),b([]),_([])}},children:e})}let l=()=>{let e=(0,r.useContext)(i);if(void 0===e)throw Error("useFilterContext must be used within a FilterProvider");return e}},73116:(e,a,t)=>{"use strict";t.d(a,{Z:()=>n});var s=t(17577),r=t(91806);function n(){(0,r.j)();let[e,a]=(0,s.useState)([]),[t,n]=(0,s.useState)(!0),[i,o]=(0,s.useState)(null),l={total:e.length,critical:e.filter(e=>"critical"===e.severity).length,warning:e.filter(e=>"warning"===e.severity).length,info:e.filter(e=>"info"===e.severity).length};return{alerts:e,loading:t,error:i,stats:l,resolveAlert:t=>{let s=[];s.includes(t)||(s.push(t),localStorage.setItem("tribuzana_resolved_alerts",JSON.stringify(s)),a(e.filter(e=>e.id!==t)))}}}t(15424),(0,t(46242).$)("4fb7291308caa69a64f14ea764e4da7ccd3eddaa")},95035:(e,a,t)=>{"use strict";t.d(a,{a:()=>s});let s=t(33136).a},68346:(e,a,t)=>{"use strict";t.d(a,{q:()=>r});var s=t(17577);function r(){let[e,a]=(0,s.useState)([]),[t,r]=(0,s.useState)(!0),[n,i]=(0,s.useState)(null);return{hoteis:e,loading:t,error:n}}t(42945)},42945:(e,a,t)=>{"use strict";t.d(a,{e:()=>i});var s=t(66305);let r=new Map;async function n(e,a,t){let s;let n=r.get(e);n&&await n;let i=new Promise(e=>{s=e});r.set(e,i);try{return await t()}finally{s(),r.delete(e)}}let i=()=>{{let e="https://hatciwhpzmyidatpiezk.supabase.co",a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhhdGNpd2hwem15aWRhdHBpZXprIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAwNDczMDAsImV4cCI6MjA3NTYyMzMwMH0.4gHLRQPAsh08ECaLUxMdSHIvegOXcAv4a_WMFmrJ_qU";if(!e||!a)throw Error("Vari\xe1veis de ambiente do Supabase n\xe3o est\xe3o configuradas. Verifique o arquivo .env.local");return(0,s.createBrowserClient)(e,a,{auth:{lock:n}})}}},11105:(e,a,t)=>{"use strict";t.d(a,{cn:()=>n});var s=t(41135),r=t(31009);function n(...e){return(0,r.m6)((0,s.W)(e))}},27696:(e,a,t)=>{"use strict";t.d(a,{WF:()=>p,c8:()=>m,e6:()=>c,f:()=>u});var s=t(33519),r=t(34231),n=t(73159),i=t(51648),o=t(69559),l=t(93663),d=t(53704);let c=()=>{let e=new Date,a=(0,s.k)(e,1),t=(0,s.k)(a,6);return{startDate:(0,r.WU)(t,"yyyy-MM-dd"),endDate:(0,r.WU)(a,"yyyy-MM-dd")}},m=()=>{let e=new Date,a=(0,n.z)((0,s.k)(e,7),{weekStartsOn:0}),t=(0,i.v)((0,s.k)(e,7),{weekStartsOn:0});return{startDate:(0,r.WU)(a,"yyyy-MM-dd"),endDate:(0,r.WU)(t,"yyyy-MM-dd")}},u=()=>{let e=new Date,a=(0,s.k)(e,1),t=(0,o.N)(e);return{startDate:(0,r.WU)(t,"yyyy-MM-dd"),endDate:(0,r.WU)(a,"yyyy-MM-dd")}},p=()=>{let e=(0,l.W)(new Date,1),a=(0,o.N)(e),t=(0,d.V)(e);return{startDate:(0,r.WU)(a,"yyyy-MM-dd"),endDate:(0,r.WU)(t,"yyyy-MM-dd")}}},85719:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>d});var s=t(19510),r=t(2171),n=t(68570);let i=(0,n.createProxy)(String.raw`C:\Users\atend\OneDrive\Documents\Cursor Tribuzana\marketing-analytics\contexts\FilterContext.tsx#FilterProvider`);(0,n.createProxy)(String.raw`C:\Users\atend\OneDrive\Documents\Cursor Tribuzana\marketing-analytics\contexts\FilterContext.tsx#useFilterContext`),(0,n.createProxy)(String.raw`C:\Users\atend\OneDrive\Documents\Cursor Tribuzana\marketing-analytics\contexts\FilterContext.tsx#useFilters`);let o=(0,n.createProxy)(String.raw`C:\Users\atend\OneDrive\Documents\Cursor Tribuzana\marketing-analytics\components\layout\Sidebar.tsx#Sidebar`),l=(0,n.createProxy)(String.raw`C:\Users\atend\OneDrive\Documents\Cursor Tribuzana\marketing-analytics\components\layout\TopBar.tsx#TopBar`);function d({children:e}){return s.jsx(r.H,{children:s.jsx(i,{children:(0,s.jsxs)("div",{className:"flex h-screen overflow-hidden bg-background",children:[s.jsx(o,{}),(0,s.jsxs)("div",{className:"flex flex-1 flex-col overflow-hidden",children:[s.jsx(l,{}),s.jsx("main",{className:"flex-1 overflow-y-auto p-6",children:e})]})]})})})}},11506:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>l,metadata:()=>o});var s=t(19510),r=t(77366),n=t.n(r),i=t(51032);t(67272);let o={title:"Tribuzana - Dashboard de Marketing Analytics",description:"Sistema de an\xe1lise de campanhas para hotelaria"};function l({children:e}){return s.jsx("html",{lang:"pt-BR",suppressHydrationWarning:!0,children:(0,s.jsxs)("body",{className:n().className,children:[e,s.jsx(i.x7,{position:"top-right",richColors:!0})]})})}},2171:(e,a,t)=>{"use strict";t.d(a,{H:()=>r});var s=t(68570);let r=(0,s.createProxy)(String.raw`C:\Users\atend\OneDrive\Documents\Cursor Tribuzana\marketing-analytics\contexts\AuthContext.tsx#AuthProvider`);(0,s.createProxy)(String.raw`C:\Users\atend\OneDrive\Documents\Cursor Tribuzana\marketing-analytics\contexts\AuthContext.tsx#useAuth`)},35629:(e,a,t)=>{"use strict";t.r(a),t.d(a,{generateAlerts:()=>d});var s=t(27745);t(26461);var r=t(94964),n=t(95744),i=t(85641),o=t(1418),l=t(88504);async function d(e){let a=(0,r.e)(),t=[];try{if(!e.startDate||!e.endDate)return console.warn("[generateAlerts] Datas n\xe3o definidas"),[];let s=a.from("metricas_ads").select("*").gte("date",e.startDate).lte("date",e.endDate);if(e.selectedHotels.length>0){let{data:t}=await a.from("metricas_ads").select("client").gte("date",e.startDate).lte("date",e.endDate),r=new Set,n=new Set(t?.map(e=>e.client).filter(Boolean)||[]);e.selectedHotels.forEach(e=>{let a=e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");n.forEach(e=>{if(e){let t=e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");(t===a||t.includes(a)||a.includes(t))&&r.add(e)}})}),r.size>0&&(s=s.in("client",Array.from(r)))}let{data:r,error:d}=await s;if(d)throw console.error("[generateAlerts] Erro ao buscar dados atuais:",d),d;let u=(0,n.WU)((0,i.k)(new Date(e.startDate),7),"yyyy-MM-dd"),p=(0,n.WU)((0,i.k)(new Date(e.endDate),7),"yyyy-MM-dd"),f=a.from("metricas_ads").select("*").gte("date",u).lte("date",p);if(e.selectedHotels.length>0){let{data:t}=await a.from("metricas_ads").select("client").gte("date",u).lte("date",p),s=new Set,r=new Set(t?.map(e=>e.client).filter(Boolean)||[]);e.selectedHotels.forEach(e=>{let a=e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");r.forEach(e=>{if(e){let t=e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");(t===a||t.includes(a)||a.includes(t))&&s.add(e)}})}),s.size>0&&(f=f.in("client",Array.from(s)))}let{data:h,error:x}=await f;x&&console.error("[generateAlerts] Erro ao buscar dados anteriores:",x);let g=await m(e.selectedHotels),y=c(r||[]),v=c(h||[]);for(let[e,a]of y.entries()){let s=g.find(e=>e.nomeHotel===a.client),r=v.get(e),n=function(e,a){let t=(0,l.zk)(e.revenue,e.spend),s=(0,l.GI)(e.spend,e.conversions),r=(0,l.O7)(e.clicks,e.impressions),n=a?.rules?.roasMin||2,i=a?.rules?.cpaMax||500,o=a?.rules?.ctrMin||1;return e.spend>0&&(t<n||s>i||r<o)?{id:`low_perf_${e.campaign_id}_${e.platform}`,type:"low_performance",severity:"critical",campaign_id:e.campaign_id,campaign_name:e.campaign_name||"Sem nome",client:e.client,platform:e.platform,message:`Baixa performance: ROAS ${t.toFixed(2)} (m\xedn: ${n}), CPA R$ ${s.toFixed(2)} (m\xe1x: ${i}), CTR ${r.toFixed(2)}% (m\xedn: ${o}%)`,metrics:{roas:t,cpa:s,ctr:r,spend:e.spend,revenue:e.revenue},actions:["Revisar segmenta\xe7\xe3o de p\xfablico","Ajustar lances e budget","Otimizar criativos e copy","Considerar pausar campanha"],created_at:new Date().toISOString(),resolved:!1}:null}(a,s);n&&t.push(n);let i=function(e){if(!e.daily_budget||0===e.daily_budget)return null;let a=e.spend/e.daily_budget*100;return a>=80&&a<100?{id:`low_budget_${e.campaign_id}_${e.platform}`,type:"low_budget",severity:"warning",campaign_id:e.campaign_id,campaign_name:e.campaign_name||"Sem nome",client:e.client,platform:e.platform,message:`Saldo baixo: ${a.toFixed(0)}% do or\xe7amento di\xe1rio utilizado`,metrics:{spend:e.spend,daily_budget:e.daily_budget,budgetUsage:a},actions:["Aumentar or\xe7amento di\xe1rio","Revisar estrat\xe9gia de lances","Monitorar performance pr\xf3ximas horas"],created_at:new Date().toISOString(),resolved:!1}:null}(a);i&&t.push(i);let d=function(e){let a=e.campaign_status?.toUpperCase();return("ACTIVE"===a||"ENABLED"===a||!a)&&0===e.spend&&e.dates.length>=2?{id:`no_spend_${e.campaign_id}_${e.platform}`,type:"no_spend",severity:"critical",campaign_id:e.campaign_id,campaign_name:e.campaign_name||"Sem nome",client:e.client,platform:e.platform,message:`Campanha ativa sem gasto h\xe1 ${e.dates.length} dias`,metrics:{spend:e.spend,days:e.dates.length},actions:["Verificar aprova\xe7\xe3o de an\xfancios","Revisar segmenta\xe7\xe3o e lances","Verificar or\xe7amento da conta","Conferir m\xe9todo de pagamento"],created_at:new Date().toISOString(),resolved:!1}:null}(a);d&&t.push(d);let c=function(e){if(!e.campaign_end_date)return null;try{let a=new Date(e.campaign_end_date),t=(0,o.j)(a,new Date);if(t>=0&&t<=3)return{id:`ending_soon_${e.campaign_id}_${e.platform}`,type:"ending_soon",severity:"warning",campaign_id:e.campaign_id,campaign_name:e.campaign_name||"Sem nome",client:e.client,platform:e.platform,message:`Campanha finaliza em ${t} dia(s)`,metrics:{end_date:e.campaign_end_date,days_remaining:t},actions:["Estender data de t\xe9rmino","Criar nova campanha similar","Avaliar resultados antes de finalizar"],created_at:new Date().toISOString(),resolved:!1}}catch{}return null}(a);c&&t.push(c);let m=function(e){if(!e.daily_budget||0===e.daily_budget)return null;let a=new Date().getHours();return e.spend>=.95*e.daily_budget&&a<18?{id:`budget_exhausted_${e.campaign_id}_${e.platform}`,type:"budget_exhausted",severity:"warning",campaign_id:e.campaign_id,campaign_name:e.campaign_name||"Sem nome",client:e.client,platform:e.platform,message:`Or\xe7amento di\xe1rio esgotado antes das 18h`,metrics:{spend:e.spend,daily_budget:e.daily_budget,hour:a},actions:["Aumentar or\xe7amento di\xe1rio","Otimizar estrat\xe9gia de lances","Distribuir budget ao longo do dia"],created_at:new Date().toISOString(),resolved:!1}:null}(a);if(m&&t.push(m),r){let e=function(e,a){let t=(0,l.YD)(e.impressions,a.impressions);return t<-50&&e.impressions>0?{id:`impression_drop_${e.campaign_id}_${e.platform}`,type:"impression_drop",severity:"critical",campaign_id:e.campaign_id,campaign_name:e.campaign_name||"Sem nome",client:e.client,platform:e.platform,message:`Queda de ${Math.abs(t).toFixed(0)}% nas impress\xf5es vs semana anterior`,metrics:{current_impressions:e.impressions,previous_impressions:a.impressions,drop_percentage:t},actions:["Verificar aprova\xe7\xe3o de an\xfancios","Aumentar lances ou or\xe7amento","Revisar segmenta\xe7\xe3o","Analisar concorr\xeancia"],created_at:new Date().toISOString(),resolved:!1}:null}(a,r);e&&t.push(e)}let u=function(e){let a=e.clicks>0?e.spend/e.clicks:0;return a>6.5&&e.clicks>10?{id:`cpc_spike_${e.campaign_id}_${e.platform}`,type:"cpc_spike",severity:"warning",campaign_id:e.campaign_id,campaign_name:e.campaign_name||"Sem nome",client:e.client,platform:e.platform,message:`CPC aumentou ${((a/5-1)*100).toFixed(0)}% acima da m\xe9dia`,metrics:{current_cpc:a,average_cpc:5,increase_percentage:(a/5-1)*100},actions:["Otimizar estrat\xe9gia de lances","Melhorar Quality Score","Revisar palavras-chave","Ajustar segmenta\xe7\xe3o"],created_at:new Date().toISOString(),resolved:!1}:null}(a);u&&t.push(u);let p=function(e){let a=e.campaign_status?.toUpperCase(),t=(0,l.zk)(e.revenue,e.spend);return("PAUSED"===a||"PAUSED_BY_USER"===a)&&t>3&&e.spend>0?{id:`paused_potential_${e.campaign_id}_${e.platform}`,type:"paused_potential",severity:"info",campaign_id:e.campaign_id,campaign_name:e.campaign_name||"Sem nome",client:e.client,platform:e.platform,message:`Campanha pausada com ROAS hist\xf3rico de ${t.toFixed(2)}`,metrics:{roas:t,spend:e.spend,revenue:e.revenue},actions:["Reativar campanha","Analisar motivo da pausa","Considerar duplicar com ajustes"],created_at:new Date().toISOString(),resolved:!1}:null}(a);p&&t.push(p);let f=function(e){if(!e.daily_budget||0===e.daily_budget)return null;let a=(0,l.zk)(e.revenue,e.spend),t=e.spend/e.daily_budget*100;return a>4&&t<50&&e.spend>0?{id:`scale_opportunity_${e.campaign_id}_${e.platform}`,type:"scale_opportunity",severity:"info",campaign_id:e.campaign_id,campaign_name:e.campaign_name||"Sem nome",client:e.client,platform:e.platform,message:`ROAS ${a.toFixed(2)} com apenas ${t.toFixed(0)}% do budget utilizado`,metrics:{roas:a,spend:e.spend,daily_budget:e.daily_budget,budget_usage:t},actions:["Aumentar or\xe7amento gradualmente","Expandir segmenta\xe7\xe3o","Duplicar campanha","Criar campanha lookalike"],created_at:new Date().toISOString(),resolved:!1}:null}(a);f&&t.push(f);let h=function(e){let a=e.search_budget_lost_impression_share;return a&&a>30?{id:`impression_share_lost_${e.campaign_id}_${e.platform}`,type:"impression_share_lost",severity:"warning",campaign_id:e.campaign_id,campaign_name:e.campaign_name||"Sem nome",client:e.client,platform:e.platform,message:`${a.toFixed(0)}% de impress\xf5es perdidas por budget limitado`,metrics:{lost_impression_share:a},actions:["Aumentar or\xe7amento da campanha","Otimizar lances","Melhorar Quality Score"],created_at:new Date().toISOString(),resolved:!1}:null}(a);h&&t.push(h)}return console.log(`[generateAlerts] Gerados ${t.length} alertas`),t}catch(e){return console.error("[generateAlerts] Erro ao gerar alertas:",e),[]}}function c(e){let a=new Map;return e.forEach(e=>{let t=`${e.campaign_id}_${e.platform}`;a.has(t)||a.set(t,{campaign_id:e.campaign_id,campaign_name:e.campaign_name,client:e.client,platform:"Google"===e.platform?"Google Ads":"Meta"===e.platform?"Meta Ads":e.platform,campaign_status:e.campaign_status,campaign_end_date:e.campaign_end_date,spend:0,revenue:0,conversions:0,clicks:0,impressions:0,daily_budget:e.min_daily_budget,search_budget_lost_impression_share:e.search_budget_lost_impression_share,dates:[]});let s=a.get(t);s.spend+=parseFloat(String(e.spend||0)),s.revenue+=parseFloat(String(e.conversions_value||0)),s.conversions+=parseInt(String(e.conversions||0),10),s.clicks+=parseInt(String(e.clicks||0),10),s.impressions+=parseInt(String(e.impressions||0),10),s.dates.push(e.date)}),a}async function m(e){let a=(0,r.e)();try{let t=a.from("hoteis_config").select("id, nome_hotel, alerta_ativo, alerta_threshold").eq("ativo",!0);e.length>0&&(t=t.in("nome_hotel",e));let{data:s,error:r}=await t;if(r)return console.error("[getAlertConfigs] Erro do Supabase:",r),[];if(!s)return[];return s.map(e=>({hotelId:e.id,nomeHotel:e.nome_hotel,rules:{roasMin:2,cpaMax:500,ctrMin:1},webhookUrl:null,webhookSecret:null,webhookActive:e.alerta_ativo||!1}))}catch(e){return console.error("[getAlertConfigs] Erro:",e),[]}}(0,t(85723).h)([d]),(0,s.j)("4fb7291308caa69a64f14ea764e4da7ccd3eddaa",d)},94964:(e,a,t)=>{"use strict";t.d(a,{e:()=>n});var s=t(96389),r=t(53973);let n=()=>{let e=(0,r.cookies)(),a="https://hatciwhpzmyidatpiezk.supabase.co",t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhhdGNpd2hwem15aWRhdHBpZXprIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAwNDczMDAsImV4cCI6MjA3NTYyMzMwMH0.4gHLRQPAsh08ECaLUxMdSHIvegOXcAv4a_WMFmrJ_qU";if(!a||!t)throw console.error("[Supabase Server] Vari\xe1veis de ambiente n\xe3o definidas:",{url:a?"OK":"FALTANDO",key:t?"OK":"FALTANDO"}),Error("Vari\xe1veis de ambiente do Supabase n\xe3o est\xe3o configuradas. Verifique o arquivo .env.local e reinicie o servidor Next.js");return(0,s.createServerClient)(a,t,{cookies:{get:a=>e.get(a)?.value,set(a,t,s){try{e.set({name:a,value:t,...s})}catch(e){}},remove(a,t){try{e.set({name:a,value:"",...t})}catch(e){}}}})}},88504:(e,a,t)=>{"use strict";t.d(a,{GI:()=>r,O7:()=>n,YD:()=>o,Zv:()=>i,zk:()=>s});let s=(e,a)=>0===a?0:e/a,r=(e,a)=>0===a?0:e/a,n=(e,a)=>0===a?0:e/a*100,i=(e,a)=>0===a?0:e/a,o=(e,a)=>0===a?e>0?100:0:(e-a)/a*100},67272:()=>{}};